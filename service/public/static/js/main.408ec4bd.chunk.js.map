{"version":3,"sources":["logo.svg","App.js","img/example1.jpg","img/example2.jpg","img/histk.png","components/TopNav.js","components/Home.js","components/SignIn.js","components/Rooms.js","components/Templates.js","components/TemplatesLanding.js","components/Room.js","reportWebVitals.js","index.js"],"names":["App","TopNav","props","useHistory","Navbar","bg","style","Brand","href","className","alt","src","width","height","paddingLeft","textAlign","fontWeight","fontSize","color","title","Toggle","aria-controls","Collapse","id","Nav","user","email","Link","onClick","firebase","auth","signOut","shuffle","Button","marginLeft","require","Home","useState","history","useEffect","huddlePreviewStyle","backgroundImage","example1","boxShadow","backgroundSize","backgroundRepeat","backgroundColor","borderRadius","marginBottom","display","huddlePreviewStyle2","example2","dec2hex","dec","toString","padStart","Jumbotron","overflowY","newId","len","arr","Uint8Array","window","crypto","getRandomValues","Array","from","join","generateId","push","marginTop","SignIn","localStream","bodyPixNet","serverConnection","roomId","testdata","bodyPix","localUuid","s4","Math","floor","random","substring","createUUID","localDisplayName","paintRunning","peerConnections","videoResWidth","videoResHeight","paint","peerConnectionConfig","Room","useParams","location","useLocation","currentRoom","undefined","state","room","roomIndex","setRoomIndex","setRoom","Date","now","initializeTimesteamp","toISOString","setLastUpdate","localUser","setLocalUser","users","setUsers","videoHeight","videoWidth","innerWidth","drawPeople","setDrawPeople","modalOpen","setModalOpen","backgroundResize","backgroundImg","document","getElementById","peopleBox","offsetWidth","offsetLeft","shuffleLocation","forward","newRoomIndex","scenes","length","applyNewRoomIndex","readyState","send","JSON","stringify","newIndex","setTimeout","audioElement","load","play","volume","console","log","constraints","video","ideal","audio","options","architecture","outputStride","multiplier","quantBytes","then","net","catch","err","loadBodyPix","navigator","mediaDevices","getUserMedia","stream","React","createRef","timestamp","current","srcObject","axios","response","initWebsocket","data","CLIENT_PREFIX","CLIENT_SUFFIX","error","start","perform","getTracks","forEach","track","stop","useLayoutEffect","addEventListener","removeEventListener","Modal","size","aria-labelledby","centered","show","onHide","Header","closeButton","Title","Body","Alert","variant","dummy","createElement","text","body","appendChild","value","select","execCommand","removeChild","copyUrlToClipboard","Footer","position","opacity","map","ref","muted","autoPlay","preview","margin","padding","index","positions","left","top","rotate","class","sound","controls","autoplay","loop","bottom","right","type","e","exportData","childNodes","node","newObj","attributes","split","att","i","attSplits","name","trim","mExport","clientPrefix","clientSuffix","url","hostname","WebSocket","onclose","event","onerror","onmessage","gotMessageFromServer","onopen","setInterval","message","signal","parse","peerUuid","uuid","dest","setScene","displayName","setUpPeer","sdp","pc","setRemoteDescription","RTCSessionDescription","createAnswer","description","createdDescription","ice","addIceCandidate","RTCIceCandidate","initCall","RTCPeerConnection","onicecandidate","gotIceCandidate","ontrack","gotRemoteStream","oniceconnectionstatechange","checkPeerDisconnect","addStream","createOffer","candidate","setLocalDescription","localDescription","some","find","newUsers","lastUpdate","sort","x","y","retryFunc","streams","iceConnectionState","splice","indexOf","a","Promise","r","vidElement","segmentPerson","flipHorizontal","internalResolution","segmentationThreshold","segmentation","canvas","context","getContext","drawImage","imageData","getImageData","pixel","p","imageSmoothingEnabled","putImageData","imageObject","Image","l","onload","canvasObj","contextObj","clearRect","toDataURL","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","exact","path","String","prototype","hashCode","ch","seed","h1","h2","this","charCodeAt","imul"],"mappings":"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","file":"static/js/main.408ec4bd.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import logo from './logo.svg';\nimport './App.css';\n\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.js</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n","export default __webpack_public_path__ + \"static/media/example1.eb2853fa.jpg\";","export default __webpack_public_path__ + \"static/media/example2.6599a032.jpg\";","export default __webpack_public_path__ + \"static/media/histk.97bb72cb.png\";","import {\n  BrowserRouter as Router,\n  useHistory\n} from \"react-router-dom\";\nimport React, { useState, useEffect } from 'react';\nimport Button from 'react-bootstrap/Button';\nimport Nav from 'react-bootstrap/Nav';\nimport Navbar from 'react-bootstrap/Navbar';\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\n\nfunction TopNav(props) {\n\n  // const [user, setUser] = useState({});\n  const history = useHistory();\n\n  // useEffect(() => {\n  //   firebase.auth().onAuthStateChanged((user) => {\n  //     if (user) {\n  //       // User is signed in, see docs for a list of available properties\n  //       // https://firebase.google.com/docs/reference/js/firebase.User\n  //       console.log(user.email);\n  //       var docRef = props.db.collection(\"users\").doc(user.email);\n\n  //       docRef.get().then((doc) => {\n  //         if (doc.exists) {\n  //           console.log(\"Document data:\", doc.data());\n  //           var userData = doc.data();\n  //           userData.email = user.email;\n  //           userData.hash = user.email.hashCode();\n\n  //           if (userData.rooms == undefined)\n  //             userData.rooms = [];\n\n  //           setUser(userData);\n  //         } else {\n  //           // doc.data() will be undefined in this case\n  //           console.log(\"No such document!\");\n  //         }\n  //       }).catch((error) => {\n  //           console.log(\"Error getting document:\", error);\n  //       });\n  //       // ...\n  //     } else {\n  //       // User is signed out\n  //       console.log(\"no user\");\n  //       history.push(\"/\");\n  //       // ...\n  //     }\n  //   });\n  // }, [user.email]);\n\n  return (\n    <Navbar bg=\"light\" style={{ \"borderRadius\": \"35px 35px\" }}>\n      <Navbar.Brand href=\"/\" className=\"mr-auto\" style={{ \"font-weight\": \"bold\", \"color\": \"darkslategray\" }}>\n        <img\n          alt=\"\"\n          src=\"/beam.svg\"\n          width=\"30\"\n          height=\"30\"\n          className=\"d-inline-block align-top\"\n        />{' '}\n        <span style={{ paddingLeft: \"3px\" }}>Beam</span>\n      </Navbar.Brand>\n      <span style={{ width: \"100%\", textAlign: \"center\", fontWeight: \"bold\", fontSize: \"20px\", color: \"darkslategray\" }}>{props.title}</span>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav className=\"mr-auto\">\n        </Nav>\n        <Nav>\n          {props.user && props.user.email && <Nav.Link onClick={signOut}>Sign Out</Nav.Link>}\n\n          {props.shuffle && <Button onClick={() => { props.shuffle(false) }}>◄</Button>}\n          {props.shuffle && <Button style={{ marginLeft: \"5px\" }} onClick={() => { props.shuffle(true) }}>►</Button>}\n        </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n  )\n\n  function signOut() {\n    firebase.auth().signOut();\n    // history.push(\"/\");\n  }\n}\n\nexport default TopNav;","import {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useRouteMatch,\n  useParams,\n  useHistory\n} from \"react-router-dom\";\n\nimport React, { useState, useEffect } from 'react';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Alert from 'react-bootstrap/Alert';\nimport Navbar from 'react-bootstrap/Navbar';\nimport NavDropdown from 'react-bootstrap/NavDropdown'\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Carousel from 'react-bootstrap/Carousel';\nimport Button from 'react-bootstrap/Button';\n\nimport example1 from '../img/example1.jpg'\nimport example2 from '../img/example2.jpg'\nimport histk from '../img/histk.png'\n\nimport TopNav from './TopNav'\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\nvar firebaseui = require('firebaseui');\n\nfunction Home(props) {\n  const user = useState();\n  const history = useHistory();\n\n  useEffect(() => {\n    // props.ui.start('#firebaseui-auth-container', {\n    //   callbacks: {\n    //     signInSuccessWithAuthResult: function (authResult, redirectUrl) {\n    //       // User successfully signed in\n    //       var userData = {\n    //         email: authResult.user.email,\n    //         id: authResult.user.email.hashCode()\n    //       }\n    //       props.db.collection(\"users\").doc(userData.email).set(userData)\n    //         .catch((error) => {\n    //           console.error(\"Error updating user document: \", error);\n    //         }, { merge: true });\n\n    //       history.push(\"/rooms\");\n    //       return false;\n    //     }\n    //   },\n    //   signInFlow: 'popup',\n    //   signInOptions: [\n    //     firebase.auth.EmailAuthProvider.PROVIDER_ID,\n    //     firebase.auth.GoogleAuthProvider.PROVIDER_ID\n    //   ],\n    //   // Other config options...\n    // });\n\n    // firebase.auth().onAuthStateChanged((user) => {\n    //   if (user) {\n    //     history.push(\"/rooms\");\n    //   } else {\n    //     console.log(\"user logged out\");\n    //   }\n    // });\n\n    return () => {\n      // Clean up the subscription\n    };\n  });\n\n  var imgStyle = {\n    height: \"150px\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n    boxShadow: \"inset 0 0 0 1000px rgba(0,0,0,.83)\",\n  }\n\n  var carItemStyle = {\n    height: \"75vh\",\n    backgroundColor: \"#F8F8F8\"\n  }\n\n  var overlayStyle = {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\",\n    backgroundColor: \"black\",\n    opacity: \".35\"\n  }\n\n  var jumboStyle = {\n    // backgroundImage: \"url(https://www.coolibri.de/wp-content/uploads/2018/07/05_11_18_Coffee_Pirates.jpg)\",\n    // boxShadow: \"rgb(90 170 255) 0px 0px 0px 1000px inset\",\n    color: \"darkslategray\",\n    // borderRadius: \"7em\",\n    // margin: \"15px\",\n    textAlign: \"center\",\n  }\n\n  var huddlePreviewStyle = {\n    backgroundImage: \"url(\" + example1 + \")\",\n    boxShadow: \"inset 0 0 0 1000px rgba(0,0,0,.20)\",\n    color: \"white\",\n    height: \"170px\",\n    width: \"210px\",\n    backgroundSize: \"auto 100%\",\n    backgroundRepeat: \"no-repeat\",\n    backgroundColor: \"transparent\",\n    borderRadius: \"15px\",\n    marginBottom: \"10px\",\n    display: \"inline-block\",\n  }\n\n  var huddlePreviewStyle2 = {\n    backgroundImage: \"url(\" + example2 + \")\",\n    boxShadow: \"inset 0 0 0 1000px rgba(0,0,0,.20)\",\n    color: \"white\",\n    height: \"170px\",\n    width: \"210px\",\n    backgroundSize: \"auto 100%\",\n    backgroundRepeat: \"no-repeat\",\n    backgroundColor: \"transparent\",\n    borderRadius: \"15px\",\n    marginBottom: \"10px\",\n    display: \"inline-block\",\n    marginLeft: \"5px\",\n  }\n\n  function dec2hex(dec) {\n    return dec.toString(16).padStart(2, \"0\")\n  }\n\n  // generateId :: Integer -> String\n  function generateId(len) {\n    var arr = new Uint8Array((len || 40) / 2)\n    window.crypto.getRandomValues(arr)\n    return Array.from(arr, dec2hex).join('')\n  }\n\n  function startNewBeam() {\n    var newId = generateId(8);\n    history.push(\"/\" + newId);\n  }\n\n  return (\n    <div>\n      <TopNav user={user} />\n      <Jumbotron style={jumboStyle}>\n        <h1 className=\"display-3\" style={{ fontWeight: \"bold\", overflowY: \"auto\" }}>Beam Together</h1>\n        <p className=\"lead\">Meet & chat in unusual & delightful locations, right in your browser.</p>\n        {/* <hr className=\"my-2\" /> */}\n        <span style={huddlePreviewStyle} /><span style={huddlePreviewStyle2} />\n        <p className=\"lead\">Start a Beam right here, share with just a link, no registration required.</p>\n        <p className=\"lead\" style={{ textAlign: \"center\" }}>\n          <center>\n            {/* <div id=\"firebaseui-auth-container\" style={{ width: \"300px\", marginTop: \"20px\" }}></div> */}\n            <Button color=\"primary\" style={{ height: \"65px\", fontSize: \"24px\" }} onClick={startNewBeam}>Start Beam</Button>\n\n            <div style={{ marginTop: \"25px\" }}>\n              Requires a webcam and microphone, and currently works in Chrome / Chromium-based browsers.\n            </div>\n\n            {/* <div style={{ marginTop: \"15px\" }}>\n              <a href=\"https://www.google.com/chrome/\">\n                <img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Google_Chrome_icon_%28September_2014%29.svg/2048px-Google_Chrome_icon_%28September_2014%29.svg.png\" width=\"50px\" />\n              </a>\n            </div> */}\n          </center>\n        </p>\n      </Jumbotron>\n\n    </div>\n  )\n}\n\nexport default Home;","import {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useRouteMatch,\n  useParams\n} from \"react-router-dom\";\nimport React, { useState } from 'react';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Toast from 'react-bootstrap/Toast';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Button from 'react-bootstrap/Button';\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\n\n//var firebase = require('firebase');\n\nvar firebaseui = require('firebaseui');\n\n\n\nfunction SignIn(props) {\n\n  props.fbui.start('#firebaseui-auth-container', {\n    callbacks: {\n      signInSuccessWithAuthResult: function(authResult, redirectUrl) {\n        // User successfully signed in.\n        // Return type determines whether we continue the redirect automatically\n        // or whether we leave that to developer to handle.\n        document.getElementById(\"firebaseui-auth-container\").innerHTML = \"signed in!\";\n        document.location.href = \"/\";\n        return false;\n      }\n    },\n    signInFlow: 'popup',\n    signInOptions: [\n      firebase.auth.EmailAuthProvider.PROVIDER_ID,\n      firebase.auth.GoogleAuthProvider.PROVIDER_ID\n    ],\n    // Other config options...\n  });\n\n  return(\n    <div>\n      <nav class=\"navbar navbar-light bg-light\" >\n        <Container fluid>\n          <a class=\"navbar-brand\" href=\"/\">\n            <img src=\"https://www.svgrepo.com/show/2230/hologram.svg\" alt=\"\" width=\"30\" height=\"24\" class=\"d-inline-block align-text-top\" />\n            Mindpads\n          </a>\n        </Container>\n      </nav>\n      <div id=\"firebaseui-auth-container\"></div>\n    </div>\n  )\n}\n\nexport default SignIn;","import {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useRouteMatch,\n  useParams,\n  useLocation,\n  useHistory\n} from \"react-router-dom\";\nimport React, { useState, useEffect } from 'react';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Toast from 'react-bootstrap/Toast';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Button from 'react-bootstrap/Button';\nimport Nav from 'react-bootstrap/Nav';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Alert from 'react-bootstrap/Alert';\n\nimport TopNav from './TopNav'\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\n\nconst testdata = require('../data/templates.json');\n\nfunction Rooms(props) {\n\n  const [user, setUser] = useState({});\n  const [dataLoaded, setDataLoaded] = useState(false);\n  const [templates, setTemplates] = useState(testdata.scenes);\n\n  const { url } = useRouteMatch();\n  let location = useLocation();\n  const history = useHistory();\n\n  useEffect(() => {\n    firebase.auth().onAuthStateChanged((user) => {\n      if (user) {\n        // User is signed in, see docs for a list of available properties\n        // https://firebase.google.com/docs/reference/js/firebase.User\n        //console.log(user.email);\n        var docRef = props.db.collection(\"users\").doc(user.email);\n\n        docRef.get().then((doc) => {\n          if (doc.exists) {\n            console.log(\"Document data:\", doc.data());\n            var userData = doc.data();\n            userData.email = user.email;\n            userData.hash = user.email.hashCode();\n\n            if (userData.rooms === undefined)\n              userData.rooms = [];\n\n            setUser(userData);\n            setDataLoaded(true);\n          } else {\n            // doc.data() will be undefined in this case\n            console.log(\"No such document!\");\n          }\n        }).catch((error) => {\n          console.log(\"Error getting document:\", error);\n        });\n        // ...\n      } else {\n        // User is signed out\n        console.log(\"no user\");\n        history.push(\"/\");\n        // ...\n      }\n    });\n  }, [user.email]);\n\n  function openRoom(template, e) {\n    // Add a new document with a generated id.\n    e.preventDefault();\n\n    var userRoom;\n    for (const [key, value] of Object.entries(user.rooms)) {\n      if (value.templateId == template.id)\n        userRoom = value;\n    }\n\n    if (userRoom === undefined) {\n      var newRoom = JSON.parse(JSON.stringify(template));\n      newRoom.owners = [\n        user.email\n      ];\n\n      newRoom.templateId = newRoom.id;\n      delete newRoom.id;\n\n      props.db.collection(\"rooms\").add(newRoom)\n        .then((docRef) => {\n          console.log(\"Document written with ID: \", docRef.id);\n\n          newRoom.id = docRef.id;\n          user.rooms.push({\n            \"id\": docRef.id,\n            \"templateId\": template.id\n          });\n\n          props.db.collection(\"users\").doc(user.email).set(user)\n            .then((docRef) => {\n              history.push(\"/rooms/\" + newRoom.id, {\n                room: newRoom\n              });\n            })\n            .catch((error) => {\n              console.error(\"Error updating user document: \", error);\n            });\n        })\n        .catch((error) => {\n          console.error(\"Error updating user document: \", error);\n        });\n    }\n    else {\n      var newRoom = JSON.parse(JSON.stringify(template));\n      newRoom.id = userRoom.id;\n      history.push(\"/rooms/\" + userRoom.id, {\n        room: newRoom\n      });\n    }\n  }\n\n  function dec2hex(dec) {\n    return dec.toString(16).padStart(2, \"0\")\n  }\n\n  // generateId :: Integer -> String\n  function generateId(len) {\n    var arr = new Uint8Array((len || 40) / 2)\n    window.crypto.getRandomValues(arr)\n    return Array.from(arr, dec2hex).join('')\n  }\n\n  return (\n    <div>\n      <TopNav user={user} />\n      <Container id=\"menuContent\" >\n        <br />\n        {/* <h1 class=\"display-5\">Locations</h1> */}\n        <Alert variant={\"primary\"}>\n          Click the \"Start Huddle! 👋\" button to open up any of these virtual locations.  Then you can forward the link to anyone to join you there for a video chat.\n        </Alert>\n\n\n        <Row>\n          {templates.map((template) =>\n            <div class=\"col-lg-4\" style={{ width: \"auto\", marginBottom: \"15px\", marginLeft: \"auto\", marginRight: \"auto\" }}>\n              <div class=\"card\" style={{ width: \"18rem\", marginLeft: \"auto\", marginRight: \"auto\" }}>\n                <img src={template.preview} class=\"card-img-top\" style={{ objectFit: \"cover\", height: \"200px\" }} alt=\"...\" />\n                <div class=\"card-body\">\n                  <h3 class=\"card-title\">{template.title}</h3>\n                  <p class=\"card-text\">{template.description}</p>\n                  <div class=\"btn-group\" role=\"group\" aria-label=\"Basic outlined example\">\n                    <button type=\"button\" class=\"btn btn-primary\" style={{ color: \"white\", textDecoration: \"none\" }} onClick={(e) => openRoom(template, e)}>\n                      Start Huddle! 👋\n                    </button>\n                  </div>\n                </div>\n                <div class=\"card-footer\">\n                  <small class=\"text-muted\">Author: Bazapi.com</small>\n                </div>\n              </div>\n            </div>\n          )}\n          <div class=\"col-lg-4\" style={{ opacity: \".7\", width: \"auto\", marginBottom: \"15px\", marginLeft: \"auto\", marginRight: \"auto\" }}>\n            <div class=\"card\" style={{ width: \"18rem\", marginLeft: \"auto\", marginRight: \"auto\" }}>\n              {/* <img src=\"https://i.pinimg.com/originals/93/29/4a/93294af6a4a352bdb07f673892efcb09.png\" class=\"card-img-top\" style={{objectFit: \"cover\", height: \"200px\"}} alt=\"...\" /> */}\n              <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRRIuaWkL6T4fqCRYqAa-fZf9UTKnhgOVymJjNLRQw9j0fG9CiFE0GRoq3uNS14sq9J86k&usqp=CAU\" class=\"card-img-top\" style={{ objectFit: \"cover\", height: \"200px\" }} alt=\"...\" />\n              <div class=\"card-body\">\n                <h3 class=\"card-title\">Coming Soon!</h3>\n                <p class=\"card-text\">Design your own Huddles, right in your browser.  It will be awesome!</p>\n                <div class=\"btn-group\" role=\"group\" aria-label=\"Basic outlined example\">\n                  {/* <button type=\"button\" class=\"btn btn-secondary\" style={{color: \"white\", textDecoration: \"none\", cursor: \"default\"}}>\n                    Coming Soon! 👋\n                  </button> */}\n                </div>\n              </div>\n              <div class=\"card-footer\">\n                <small class=\"text-muted\">Author: Bazapi.com</small>\n              </div>\n            </div>\n          </div>\n        </Row>\n        <br></br><br></br>\n      </Container>\n    </div>\n  );\n}\n\nexport default Rooms;","import {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useRouteMatch,\n  useParams,\n  useLocation,\n  useHistory\n} from \"react-router-dom\";\nimport React, { useState, useEffect } from 'react';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Toast from 'react-bootstrap/Toast';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Button from 'react-bootstrap/Button';\nimport Nav from 'react-bootstrap/Nav';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Alert from 'react-bootstrap/Alert';\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\n\nconst indexData = require('../data/templates.json');\n\nexport default function Templates(props) {\n\n  const [user, setUser] = useState({});\n  const [dataLoaded, setDataLoaded] = useState(false);\n  const [pads, setPads] = useState({});\n  const [templates, setTemplates] = useState(indexData.scenes);\n\n  const { url } = useRouteMatch();\n  let location = useLocation();\n  const history = useHistory();\n  \n  useEffect(() => {\n    firebase.auth().onAuthStateChanged((user) => {\n      if (user) {\n        // User is signed in, see docs for a list of available properties\n        // https://firebase.google.com/docs/reference/js/firebase.User\n        console.log(user.email);\n        var docRef = props.db.collection(\"users\").doc(user.email);\n  \n        docRef.get().then((doc) => {\n          if (doc.exists) {\n            console.log(\"Document data:\", doc.data());\n            var userData = doc.data();\n            userData.email = user.email;\n            userData.hash = user.email.hashCode();\n\n            setUser(userData);\n            if (userData.pads) setPads(userData.pads);\n            setDataLoaded(true);\n          } else {\n            // doc.data() will be undefined in this case\n            console.log(\"No such document!\");\n          }\n        }).catch((error) => {\n            console.log(\"Error getting document:\", error);\n        });\n        // ...\n      } else {\n        // User is signed out\n        console.log(\"no user\");\n        history.push(\"/\");\n        // ...\n      }\n    });\n  }, [user.email]);\n  \n\n  function signOut() {\n    firebase.auth().signOut();\n  }\n\n  return (\n  <div>\n    <Navbar bg=\"light\" expand=\"lg\">\n      <Navbar.Brand href=\"/\" className=\"mr-auto\">\n        <img\n          alt=\"\"\n          src=\"logo18.png\"\n          width=\"30\"\n          height=\"30\"\n          className=\"d-inline-block align-top\"\n        />{' '}\n        Mindpads.com\n      </Navbar.Brand>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav className=\"mr-auto\" style={{marginLeft: \"10px\", marginTop: \"4px\"}}>\n\n          <Nav.Link href=\"/templates\">Templates</Nav.Link>\n        </Nav>\n        <Nav>\n          <Nav.Link onClick={signOut}>Sign Out</Nav.Link>\n        </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n    <Container id=\"menuContent\" >\n      <br/>\n\n      <h1 class=\"display-5\">Templates</h1>\n      <br/>\n      <Row>\n          {templates.map((template) =>\n            <div class=\"col-lg-4\" style={{\"margin-bottom\": \"15px\"}}>\n              <div class=\"card\" style={{\"width\": \"18rem\"}}>\n                <img src={template.preview} class=\"card-img-top\" style={{objectFit: \"cover\", height: \"200px\"}} alt=\"...\" />\n                <div class=\"card-body\">\n                  <h5 class=\"card-title\">{template.title}</h5>\n                  <p class=\"card-text\">{template.description}</p>\n                  <div class=\"btn-group\" role=\"group\" aria-label=\"Basic outlined example\">\n                    <button type=\"button\" class=\"btn btn-primary\" style={{color: \"white\", textDecoration: \"none\"}} >\n                      <Link style={{color: \"white\"}} to={\"/\" + template.id}>Open ➚</Link>\n                    </button>\n                  </div>\n                </div>\n                <div class=\"card-footer\">\n                  <small class=\"text-muted\">Last updated 3 mins ago</small>\n                </div>\n              </div>\n            </div>\n          )}\n      </Row>\n      <br></br><br></br>\n    </Container>\n  </div>\n  );\n}\n","import {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useRouteMatch,\n  useParams,\n  useLocation,\n  useHistory\n} from \"react-router-dom\";\nimport React, { useState, useEffect } from 'react';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Toast from 'react-bootstrap/Toast';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Button from 'react-bootstrap/Button';\nimport Nav from 'react-bootstrap/Nav';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Alert from 'react-bootstrap/Alert';\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\n\nconst indexData = require('../data/templates.json');\n\nexport default function TemplatesLanding(props) {\n\n  let {id} = useParams();\n  const [user, setUser] = useState({});\n  const [dataLoaded, setDataLoaded] = useState(false);\n  const [pads, setPads] = useState({});\n  const [templates, setTemplates] = useState(indexData.scenes);\n\n  const { url } = useRouteMatch();\n  let location = useLocation();\n  const history = useHistory();\n  \n  useEffect(() => {\n    firebase.auth().onAuthStateChanged((user) => {\n      if (user) {\n        // User is signed in, see docs for a list of available properties\n        // https://firebase.google.com/docs/reference/js/firebase.User\n        console.log(user.email);\n        var docRef = props.db.collection(\"users\").doc(user.email);\n  \n        docRef.get().then((doc) => {\n          if (doc.exists) {\n            console.log(\"Document data:\", doc.data());\n            var userData = doc.data();\n            userData.email = user.email;\n            userData.hash = user.email.hashCode();\n\n            setUser(userData);\n            if (userData.pads) setPads(userData.pads);\n            setDataLoaded(true);\n          } else {\n            // doc.data() will be undefined in this case\n            console.log(\"No such document!\");\n          }\n        }).catch((error) => {\n            console.log(\"Error getting document:\", error);\n        });\n        // ...\n      } else {\n        // User is signed out\n        console.log(\"no user\");\n        history.push(\"/\");\n        // ...\n      }\n    });\n  }, [user.email]);\n  \n  useEffect(() => {\n    fetch(\"/data/\")\n  }, [id]);\n\n  function signOut() {\n    firebase.auth().signOut();\n  }\n\n  return (\n  <div>\n    <Navbar bg=\"light\" expand=\"lg\">\n      <Navbar.Brand href=\"/\" className=\"mr-auto\">\n        <img\n          alt=\"\"\n          src=\"logo18.png\"\n          width=\"30\"\n          height=\"30\"\n          className=\"d-inline-block align-top\"\n        />{' '}\n        Mindpads.com\n      </Navbar.Brand>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav className=\"mr-auto\" style={{marginLeft: \"10px\", marginTop: \"4px\"}}>\n\n          <Nav.Link href=\"/templates\">Templates</Nav.Link>\n        </Nav>\n        <Nav>\n          <Nav.Link onClick={signOut}>Sign Out</Nav.Link>\n        </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n    <Container id=\"menuContent\" >\n      <br/>\n\n      <h1 class=\"display-5\">Templates</h1>\n      <br/>\n      <Row>\n          {templates.map((template) =>\n            <div class=\"col-lg-4\" style={{\"margin-bottom\": \"15px\"}}>\n              <div class=\"card\" style={{\"width\": \"18rem\"}}>\n                <img src={template.preview} class=\"card-img-top\" style={{objectFit: \"cover\", height: \"200px\"}} alt=\"...\" />\n                <div class=\"card-body\">\n                  <h5 class=\"card-title\">{template.title}</h5>\n                  <p class=\"card-text\">{template.description}</p>\n                  <div class=\"btn-group\" role=\"group\" aria-label=\"Basic outlined example\">\n                    <button type=\"button\" class=\"btn btn-primary\" style={{color: \"white\", textDecoration: \"none\"}} >\n                      <Link to={\"/\" + template.id}>Open ➚</Link>\n                    </button>\n                  </div>\n                </div>\n                <div class=\"card-footer\">\n                  <small class=\"text-muted\">Last updated 3 mins ago</small>\n                </div>\n              </div>\n            </div>\n          )}\n      </Row>\n      <br></br><br></br>\n    </Container>\n  </div>\n  );\n}\n","import React, { useState, useEffect, useLayoutEffect } from 'react';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useParams,\n  useRouteMatch,\n  useLocation,\n  useHistory\n} from \"react-router-dom\";\n\nimport axios from 'axios';\n\nimport * as tf from '@tensorflow/tfjs';\n\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport Alert from 'react-bootstrap/Alert';\n\nimport TopNav from './TopNav'\n\nimport firebase from \"firebase/app\";\nimport \"firebase/firestore\";\n\nconst testdata = require('../data/templates.json');\n\nconst bodyPix = require('@tensorflow-models/body-pix');\n\nvar localUuid = createUUID();\nvar localDisplayName = localUuid;\nvar localStream;\nvar bodyPixNet;\nvar paintRunning = false;\nvar serverConnection;\nvar peerConnections = {};\nvar videoResWidth = 240;\nvar videoResHeight = 240;\nvar roomId;\n\nvar paint = true;\n\nvar peerConnectionConfig = {\n  'iceServers': [\n    { 'urls': 'stun:stun.stunprotocol.org:3478' },\n    { 'urls': 'stun:stun.l.google.com:19302' },\n  ]\n};\n\nfunction Room(props) {\n\n  // let [user, setUser] = useState()\n  let { id } = useParams();\n  let location = useLocation();\n  var currentRoom = undefined;\n  if (location.state && location.state.room)\n    currentRoom = location.state.room;\n\n  let [roomIndex, setRoomIndex] = useState(0);\n  let [room, setRoom] = useState(currentRoom);\n  let [initializeTimesteamp] = useState(Date.now());\n  let [lastUpdate, setLastUpdate] = useState((new Date()).toISOString());\n  let [localUser, setLocalUser] = useState();\n  let [users, setUsers] = useState([]);\n  let [userIds, setUserIds] = useState([]);\n  let [videoHeight] = useState(videoResHeight);\n  let [videoWidth] = useState(videoResWidth);\n\n  let [backgroundWidth, setBackgroundWidth] = useState(1682);\n  let [backgroundHeight, setBackgroundHeight] = useState(1231);\n  let [windowWidth] = useState(window.innerWidth);\n\n  let [toolboxOpen, setToolboxOpen] = useState(false);\n  let [drawPeople, setDrawPeople] = useState(true);\n  let [modalOpen, setModalOpen] = useState(true);\n\n  const history = useHistory();\n\n  roomId = id;\n\n  console.log(\"STARTING ROOM for \" + localUuid);\n\n  // firebase.auth().onAuthStateChanged((user) => {\n  //   if (user) {\n  //     setUser(user);\n  //   } else {\n  //     console.log(\"user logged out\");\n  //     history.push(\"/\");\n  //   }\n  // });\n\n  useEffect(() => {\n    console.log(\"ENTER UseEffect\");\n    applyNewRoomIndex(roomIndex);\n\n    // setRoom(testdata.scenes[roomIndex]);\n\n    // setTimeout(function () {\n    //   backgroundResize();\n    // }, 500);\n    // if (!room) {\n    //   var docRef = props.db.collection(\"rooms\").doc(id);\n\n    //   docRef.get().then((doc) => {\n    //     if (doc.exists) {\n    //       var roomData = doc.data();\n\n    //       setRoom(roomData);\n    //     } else {\n    //       // doc.data() will be undefined in this case\n    //       console.log(\"No such room!\");\n    //     }\n    //   }).catch((error) => {\n    //     console.log(\"Error getting room:\", error);\n    //   });\n    // }\n\n    start();\n\n    paint = true;\n    perform();\n\n    return () => {\n      // Clean up the subscription\n      paint = false;\n\n      if (localStream) {\n        const tracks = localStream.getTracks();\n\n        tracks.forEach(function (track) {\n          track.stop();\n        });\n\n        //localStream.getTracks()[0].stop();\n      }\n\n      console.log(\"EXIT UseEffect\")\n    };\n  }, [initializeTimesteamp]);\n\n  useLayoutEffect(() => {\n    console.log(\"ENTER UseLayoutEffect\");\n    backgroundResize();\n    window.addEventListener('resize', backgroundResize);\n\n    return () => {\n      //if (localUser && localUser.video) localUser.video.current.srcObject = null;\n      window.removeEventListener('resize', backgroundResize);\n      console.log(\"EXIT UseLayoutEffect\");\n    };\n  });\n\n  function backgroundResize() {\n    var backgroundImg = document.getElementById('backgroundimage');\n    var peopleBox = document.getElementById('peopleBox');\n\n    if (backgroundImg) {\n      peopleBox.style[\"width\"] = backgroundImg.offsetWidth + \"px\";\n      peopleBox.style[\"left\"] = backgroundImg.offsetLeft + \"px\";\n    }\n  }\n\n  function mExport(e) {\n    console.log(\"hello\")\n\n    var peopleBox = document.getElementById(\"peopleBox\");\n    var exportData = [];\n\n    peopleBox.childNodes.forEach((node, index) => {\n      console.log(\"child\");\n\n      var newObj = {};\n      var styles = node.attributes.style.value.split(\";\");\n      styles.forEach((att, i) => {\n        var attSplits = att.split(\":\");\n        if (attSplits.length > 1) {\n          var name = attSplits[0].trim();\n          var value = attSplits[1].trim();\n\n          if (name === \"--top\") {\n            newObj.top = value;\n          }\n          else if (name == \"--left\") {\n            newObj.left = value;\n          }\n          else if (name == \"--width\") {\n            newObj.width = value;\n          }\n          else if (name == \"--height\") {\n            newObj.height = value;\n          }\n          else if (name == \"--rotate\") {\n            newObj.rotate = value;\n          }\n        }\n      });\n\n      exportData.push(newObj);\n    });\n\n    console.log(JSON.stringify(exportData, null, 2));\n  }\n\n  function copyUrlToClipboard() {\n    var dummy = document.createElement('input'),\n      text = window.location.href;\n\n    document.body.appendChild(dummy);\n    dummy.value = text;\n    dummy.select();\n    document.execCommand('copy');\n    document.body.removeChild(dummy);\n  }\n\n  function shuffleLocation(forward = true) {\n    var newRoomIndex = roomIndex + 1;\n\n    if (!forward)\n      newRoomIndex = newRoomIndex - 2;\n\n    if (newRoomIndex >= testdata.scenes.length) newRoomIndex = 0;\n    if (newRoomIndex < 0) newRoomIndex = testdata.scenes.length - 1;\n\n    applyNewRoomIndex(newRoomIndex);\n\n    if (serverConnection && serverConnection.readyState == 1)\n      serverConnection.send(JSON.stringify({ 'displayName': localDisplayName, 'uuid': localUuid, 'setScene': newRoomIndex, 'dest': roomId, 'room': roomId, 'timestamp': initializeTimesteamp }));\n\n  }\n\n  function applyNewRoomIndex(newIndex) {\n\n    setDrawPeople(false);\n\n    setRoomIndex(newIndex);\n    setRoom(testdata.scenes[newIndex]);\n\n    setTimeout(function () {\n      backgroundResize();\n      setDrawPeople(true);\n      var audioElement = document.getElementById(\"backgroundAudio\");\n      if (audioElement) {\n        audioElement.load();\n        audioElement.play();\n        audioElement.volume = .4;\n      }\n    }, 1500);\n  }\n\n  function onModalClose() {\n    setModalOpen(false)\n  }\n\n  return (\n    <div>\n      {room ? <TopNav shuffle={shuffleLocation} title={room.title} /> : <TopNav shuffle={shuffleLocation} />}\n      <Modal\n        size=\"lg\"\n        aria-labelledby=\"contained-modal-title-vcenter\"\n        centered\n        show={modalOpen}\n        onHide={() => onModalClose()}\n      >\n        <Modal.Header closeButton>\n          <Modal.Title id=\"contained-modal-title-vcenter\">\n            Welcome to your Beam!\n          </Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          {/* <h4>Centered Modal</h4> */}\n          <p>\n            You can invite anyone to join by sending them the link to this page:\n            <br />\n            <br />\n            <Alert id=\"urlAlert\" variant={\"primary\"}>\n              {window.location.href}\n            </Alert>\n            <Button onClick={() => copyUrlToClipboard()}>Copy link to clipboard</Button>\n            <br />\n            <br />\n            They will not have to register - anyone can join a Beam by just clicking on the link.\n          </p>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button onClick={() => setModalOpen(false)}>Close</Button>\n        </Modal.Footer>\n      </Modal>\n      <div id=\"menuContent\" className=\"container-fluid\">\n        <div id=\"videos\" className=\"videos\" style={{ position: \"fixed\", opacity: \"0\" }}>\n          {users.map((user) =>\n            user.id === localUser.id\n              ? <video id={\"video_\" + user.id} key={user.id} ref={user.video} muted autoPlay height={videoHeight} width={videoWidth} />\n              : <video id={\"video_\" + user.id} key={user.id} ref={user.video} autoPlay height={videoHeight} width={videoWidth} />\n          )}\n        </div>\n\n        {room &&\n          <div id=\"background\" className=\"row\">\n            <img alt=\"Tiny Trip background\" id=\"backgroundimage\" src={room.preview} style={{ height: \"calc(100vh - 56px)\", margin: \"auto\", \"padding\": \"0px\" }} />\n            <div id=\"peopleBox\" style={{ position: \"absolute\", height: \"calc(100vh - 56px)\", margin: \"auto\", padding: \"auto\" }}  >\n              {drawPeople && users.map((user, index) =>\n                index < room.positions.length\n                  ? <deckgo-drr id={\"box_\" + user.id} key={user.id} style={{ \"--width\": room.positions[index].width, \"--height\": room.positions[index].height, \"--left\": room.positions[index].left, \"--top\": room.positions[index].top, \"--rotate\": room.positions[index].rotate }}>\n                    <canvas id={\"canvas_\" + user.id} height=\"240px\" width=\"240px\" class=\"animate__animated animate__fadeInDown\"/>\n                  </deckgo-drr>\n                  : <deckgo-drr id={\"box_\" + user.id} key={user.id} style={{ \"--width\": \"10%\", \"--height\": \"10%\" }}>\n                    <canvas id={\"canvas_\" + user.id} height=\"240px\" width=\"240px\" class=\"animate__animated animate__fadeInDown\" />\n                  </deckgo-drr>\n              )}\n            </div>\n            {room.sound &&\n              <audio controls id=\"backgroundAudio\" autoplay loop style={{ position: \"fixed\", bottom: \"10px\", right: \"14px\", width: \"125px\" }}>\n                <source src={room.sound} type=\"audio/mpeg\" />\n              </audio>\n            }\n            <Button style={{ position: \"fixed\", bottom: \"10px\", left: \"10px\" }} onClick={() => { mExport(); setModalOpen(true); }}>Join Info</Button>\n          </div>\n        }\n      </div>\n    </div>\n  );\n\n  function start() {\n\n    var constraints = {\n      video: {\n        width: {\n          ideal: videoResWidth\n        },\n        height: {\n          ideal: videoResHeight\n        }\n      },\n      audio: true,\n    };\n\n    // var constraints = {\n    //   video: true,\n    //   audio: true,\n    // };\n\n    if (!bodyPixNet) loadBodyPix();\n\n    // set up local video stream\n    if (navigator.mediaDevices.getUserMedia) {\n      navigator.mediaDevices.getUserMedia(constraints)\n        .then(stream => {\n          // if (userIds.indexOf(localUuid) == -1) {\n          //setLocalStream(stream);\n          localStream = stream;\n          var user = { id: localUuid, video: React.createRef(), timestamp: initializeTimesteamp };\n          setLocalUser(user);\n          users.push(user);\n          setUsers([user]);\n\n          if (user.video.current) {\n            user.video.current.srcObject = stream;\n          }\n\n          axios(\"/parameters\").then(function (response) {\n            initWebsocket(response.data.CLIENT_PREFIX, response.data.CLIENT_SUFFIX);\n          })\n\n        }).catch((error) => {\n          console.log(\"Error starting webcam, probably is not enabled for this site.\")\n        }).then(() => {\n          // if (!serverConnection) {\n          //   serverConnection = new WebSocket(\"wss://localhost:8443\");\n          //   serverConnection.onmessage = gotMessageFromServer;\n          //   serverConnection.onopen = event => {\n          //     serverConnection.send(JSON.stringify({ 'displayName': localDisplayName, 'uuid': localUuid, 'dest': roomId, 'room': roomId, 'timestamp': ts }));\n          //   } \n          // }\n          // axios(\"/parameters\").then(function(response) {\n          //   var url = 'wss://' + window.location.hostname;\n          //   if (response.data.CLIENT_SUFFIX) url += response.data.CLIENT_SUFFIX;\n          //   serverConnection = new WebSocket(url);\n          //   serverConnection.onmessage = gotMessageFromServer;\n          //   serverConnection.onopen = event => {\n          //     serverConnection.send(JSON.stringify({ 'displayName': localDisplayName, 'uuid': localUuid, 'dest': roomId, 'room': roomId, 'timestamp': ts }));\n          //   }\n          // })\n\n        }).catch((error) => {\n          console.log(\"Error starting webcam, probably is not enabled for this site.\")\n        });\n\n    } else {\n      //alert('Your browser does not support getUserMedia API');\n    }\n  }\n\n  function initWebsocket(clientPrefix, clientSuffix) {\n    var url = clientPrefix ? clientPrefix + window.location.hostname : 'wss://' + window.location.hostname;\n    if (clientSuffix) url += clientSuffix;\n    serverConnection = new WebSocket(url);\n    serverConnection.onclose = function (event) {\n      console.log(\"WebSocket is closed now, trying to reopen...\");\n      // setTimeout(function() {\n      //   initWebsocket(clientSuffix);\n      // }, 1000);\n    };\n    serverConnection.onerror = function (event) {\n      console.error(\"WebSocket error observed: \", event);\n    };\n    serverConnection.onmessage = gotMessageFromServer;\n    serverConnection.onopen = event => {\n      serverConnection.send(JSON.stringify({ 'displayName': localDisplayName, 'uuid': localUuid, 'dest': roomId, 'room': roomId, 'timestamp': initializeTimesteamp }));\n\n      setInterval(function () {\n        // keep alive websocket\n        if (serverConnection.readyState == 1)\n          serverConnection.send(JSON.stringify({ 'displayName': localDisplayName, 'uuid': localUuid, 'dest': \"ping\", 'room': roomId, 'timestamp': initializeTimesteamp }));\n        else {\n          console.log(\"Would like to ping websocket server, but is closed, so trying to reopen...\")\n          initWebsocket(clientPrefix, clientSuffix);\n        }\n\n      }, 5000);\n    }\n  }\n\n  function gotMessageFromServer(message) {\n    var signal = JSON.parse(message.data);\n    var peerUuid = signal.uuid;\n\n    if (signal.dest == roomId && signal.setScene !== undefined) {\n\n      applyNewRoomIndex(signal.setScene);\n      // setRoomIndex(signal.setScene);\n      // setRoom(testdata.scenes[signal.setScene]);\n\n      // setTimeout(function () {\n      //   backgroundResize();\n      // }, 500);\n    }\n\n    // Ignore messages that are not for us or from ourselves\n    if (peerUuid == localUuid || (signal.dest != localUuid && signal.dest != roomId) || !peerUuid) return;\n\n    if (signal.displayName && signal.dest == roomId) {\n      // set up peer connection object for a newcomer peer\n      setUpPeer(peerUuid, signal.displayName, signal.timestamp);\n      serverConnection.send(JSON.stringify({ 'displayName': localDisplayName, 'uuid': localUuid, 'dest': peerUuid, 'room': roomId, 'timestamp': initializeTimesteamp }));\n    } else if (signal.displayName && signal.dest == localUuid) {\n      // initiate call if we are the newcomer peer\n      setUpPeer(peerUuid, signal.displayName, signal.timestamp, true);\n    } else if (signal.sdp) {\n      peerConnections[peerUuid].pc.setRemoteDescription(new RTCSessionDescription(signal.sdp)).then(function () {\n        // Only create answers in response to offers\n        if (signal.sdp.type == 'offer') {\n          peerConnections[peerUuid].pc.createAnswer().then(description => createdDescription(description, peerUuid));\n        }\n      });\n\n    } else if (signal.ice) {\n      peerConnections[peerUuid].pc.addIceCandidate(new RTCIceCandidate(signal.ice));\n    }\n  }\n\n  function setUpPeer(peerUuid, displayName, timestamp, initCall = false) {\n    peerConnections[peerUuid] = { 'displayName': displayName, 'pc': new RTCPeerConnection(peerConnectionConfig) };\n    peerConnections[peerUuid].pc.onicecandidate = event => gotIceCandidate(event, peerUuid);\n    peerConnections[peerUuid].pc.ontrack = event => gotRemoteStream(event, peerUuid, timestamp);\n    peerConnections[peerUuid].pc.oniceconnectionstatechange = event => checkPeerDisconnect(event, peerUuid);\n    peerConnections[peerUuid].pc.addStream(localStream);\n\n    if (initCall) {\n      peerConnections[peerUuid].pc.createOffer().then(description => createdDescription(description, peerUuid));\n    }\n  }\n\n  function gotIceCandidate(event, peerUuid) {\n    if (event.candidate != null) {\n      serverConnection.send(JSON.stringify({ 'ice': event.candidate, 'uuid': localUuid, 'dest': peerUuid, 'room': roomId }));\n    }\n  }\n\n  function createdDescription(description, peerUuid) {\n    console.log(`got description, peer ${peerUuid}`);\n    peerConnections[peerUuid].pc.setLocalDescription(description).then(function () {\n      serverConnection.send(JSON.stringify({ 'sdp': peerConnections[peerUuid].pc.localDescription, 'uuid': localUuid, 'dest': peerUuid, 'room': roomId }));\n    });\n  }\n\n  function gotRemoteStream(event, peerUuid, timestamp) {\n    console.log(`got remote stream, peer ${peerUuid}`);\n    //assign stream to new user object\n    var user;\n    if (!users.some(user => user[\"id\"] === peerUuid)) {\n\n      var newUsers = users;\n      user = { id: peerUuid, video: React.createRef(), timestamp: timestamp };\n      user.lastUpdate = (new Date()).toISOString();\n      newUsers.push(user);\n      setUsers(newUsers);\n    }\n    else {\n      user = users.find(user => user[\"id\"] === peerUuid);\n    }\n\n    users.sort(function (x, y) {\n      return x.timestamp - y.timestamp;\n    });\n\n    setLastUpdate(user.lastUpdate);\n\n    var retryFunc = function () {\n      if (user.video.current) {\n        user.video.current.srcObject = event.streams[0];\n      }\n      else {\n        user.lastUpdate = (new Date()).toISOString();\n        setLastUpdate(user.lastUpdate);\n\n        setUsers(users);\n        setTimeout(retryFunc, 50);\n      }\n    }\n\n    retryFunc();\n\n    // var vidElement = document.createElement('video');\n    // vidElement.setAttribute('autoplay', '');\n    // vidElement.setAttribute('muted', '');\n    // vidElement.setAttribute('width', videoResWidth + \"px\");\n    // vidElement.setAttribute('height', videoResHeight + \"px\");\n    // vidElement.setAttribute('tag', peerUuid);\n    // vidElement.srcObject = event.streams[0];\n\n    // vidElements.push(vidElement);\n    // vidGuuids.push(peerUuid);\n    // vidMetadata.push({\n    //   timestamp: timestamp,\n    //   uuid: peerUuid,\n    //   elem: vidElement\n    // });\n\n    // console.log(vidMetadata[0].timestamp);\n    // console.log(vidMetadata[1].timestamp);\n\n    // vidMetadata.sort(function(x, y) {\n    //   return x.timestamp - y.timestamp;\n    // });\n\n    // var vidContainer = document.createElement('div');\n    // vidContainer.setAttribute('id', 'remoteVideo_' + peerUuid);\n    // vidContainer.setAttribute('class', 'videoContainer');\n    // vidContainer.appendChild(vidElement);\n    // //vidContainer.appendChild(makeLabel(peerConnections[peerUuid].displayName));\n\n    // document.getElementById('videos').appendChild(vidContainer);\n  }\n\n  function checkPeerDisconnect(event, peerUuid) {\n    var state = peerConnections[peerUuid].pc.iceConnectionState;\n    console.log(`connection with peer ${peerUuid} ${state}`);\n    if (state === \"failed\" || state === \"closed\" || state === \"disconnected\") {\n      delete peerConnections[peerUuid];\n      let user = users.find(user => user['id'] === peerUuid);\n      if (user) users.splice(users.indexOf(user), 1);\n      setUsers(users);\n      setLastUpdate((new Date()).toISOString());\n\n      // document.getElementById('videos').removeChild(document.getElementById('remoteVideo_' + peerUuid));\n      // vidGuuids.splice(vidGuuids.indexOf(peerUuid), 1);\n      // for(var p=0; p<vidMetadata.length; p++) {\n      //   if (vidMetadata[p].uuid == peerUuid) {\n      //     vidMetadata.splice(p, 1);\n\n      //     if (p < contexts.length)\n      //       contexts[p].clearRect(0, 0, videoResWidth, videoResHeight);\n\n      //     break;\n      //   }\n      // }\n    }\n  }\n\n  function loadBodyPix() {\n    var options = {\n      architecture: 'MobileNetV1',\n      outputStride: 16,\n      multiplier: 0.75,\n      quantBytes: 2\n    }\n    bodyPix.load(options)\n      .then(net => {\n        bodyPixNet = net;\n        //perform();\n      })\n      .catch(err => console.log(err))\n  }\n\n  async function perform() {\n\n    console.log(\"ENTER PERFORM\")\n    while (!bodyPixNet) {\n      await new Promise(r => setTimeout(r, 100));\n    }\n\n    if (paintRunning) {\n      console.log(\"paint already running, exiting...\")\n    }\n    else {\n      paintRunning = true;\n      console.log(\"START PAINT LOOP\")\n      while (paint) {\n\n        // if (vidMetadata.length > 0) {\n        //   for(var c=contexts.length - 1; c > vidMetadata.length - 1; c--)\n        //     contexts[c].clearRect(0, 0, videoResWidth, videoResHeight);\n        // }\n        for (var i = 0; i < users.length; i++) {\n          var user = users[i];\n          var vidElement = users[i].video.current;\n          try {\n            var segmentation = await bodyPixNet.segmentPerson(vidElement, {\n              flipHorizontal: false,\n              internalResolution: 'medium',\n              segmentationThreshold: 0.5\n            });\n\n            var canvas = document.createElement('canvas');\n            canvas.width = videoResWidth;\n            canvas.height = videoResHeight;\n            var context = canvas.getContext('2d');\n            context.drawImage(vidElement, 0, 0);\n            var imageData = context.getImageData(0, 0, videoResWidth, videoResHeight);\n\n            var pixel = imageData.data;\n            for (var p = 0; p < pixel.length; p += 4) {\n              if (segmentation.data[p / 4] == 0) {\n                pixel[p + 3] = 0;\n              }\n              else\n                pixel[p + 3] = 255;\n            }\n            context.imageSmoothingEnabled = true;\n            context.putImageData(imageData, 0, 0);\n\n            var imageObject = new Image();\n            var l = i;\n            imageObject.onload = function () {\n              if (l < users.length) {\n                var canvasObj = document.getElementById(\"canvas_\" + users[l].id);\n\n                if (canvasObj) {\n                  var contextObj = canvasObj.getContext(\"2d\");\n                  contextObj.clearRect(0, 0, canvas.width, canvas.height);\n                  contextObj.imageSmoothingEnabled = true;\n                  contextObj.drawImage(imageObject, 0, 0, canvas.width, canvas.height);\n                }\n                else {\n                  console.log(\"Error no canvas object found for user \" + l);\n                }\n              }\n              else\n                console.log(\"Error no user found for index \" + l);\n            }\n\n            imageObject.src = canvas.toDataURL();\n          } catch (error) {\n            //console.error(error);\n          }\n        }\n\n        await new Promise(r => setTimeout(r, 100));\n      }\n\n      paintRunning = false;\n      console.log(\"END PAINT LOOP\")\n    }\n\n    console.log(\"EXIT PERFORM\")\n  }\n}\n\nfunction createUUID() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n\nexport default Room;","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useRouteMatch,\n  useParams\n} from \"react-router-dom\";\n\nimport App from './App';\nimport Home from './components/Home'\nimport SignIn from './components/SignIn'\nimport Rooms from './components/Rooms'\nimport Templates from './components/Templates'\nimport TemplatesLanding from './components/TemplatesLanding'\nimport Room from './components/Room'\nimport reportWebVitals from './reportWebVitals';\n\n// Importing the Bootstrap CSS\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router>\n      <Switch>\n        <Route exact path=\"/\">\n          <Home />\n        </Route>\n        <Route exact path=\"/:id\">\n          <Room />\n        </Route>\n      </Switch>\n    </Router>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n\nString.prototype.hashCode = function (seed = 0) {\n  let h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\n  for (let i = 0, ch; i < this.length; i++) {\n    ch = this.charCodeAt(i);\n    h1 = Math.imul(h1 ^ ch, 2654435761);\n    h2 = Math.imul(h2 ^ ch, 1597334677);\n  }\n  h1 = Math.imul(h1 ^ (h1 >>> 16), 2246822507) ^ Math.imul(h2 ^ (h2 >>> 13), 3266489909);\n  h2 = Math.imul(h2 ^ (h2 >>> 16), 2246822507) ^ Math.imul(h1 ^ (h1 >>> 13), 3266489909);\n  return 4294967296 * (2097151 & h2) + (h1 >>> 0);\n};"],"sourceRoot":""}